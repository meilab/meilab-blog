---
templateKey: dailycoding-post
title: 两个bug
date: 2020-08-27T05:05:16.848Z
tags:
  - 编程
---
我家领导前些天给AES算法添加掩码，修改了代码之后，结果不对，让我帮忙调试。

因为是针对嵌入式写的代码，PC上跑不了，硬件本身也有限制，导致我没办法单步调试，也没办法通过打印调试，只能硬着头皮做code review。

第一个问题是：板子死机了，没有任何反馈。因为定义了一个u8当计数器做循环，边界是256，直接死循环了，因为u8最大是255。

第二个问题是加密结果不对。因为tmp和state0都是数组。直接赋值其实是指针操作，会使得tmp指向state0，导致后续的计算错误。需要改成深度拷贝。

两点体会：

第一:很怀念单步调试，和加打印调试，效率会高很多。纯看代码找问题挺挠头的。

第二:Lint是个好东东，其实这两个问题，按说lint应该都是能够发现的。

下次聊聊Lint